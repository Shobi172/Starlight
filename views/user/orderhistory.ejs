<%- include("../partials/userheader.ejs") %>

<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-rbsA2VBKQhggwzxH7pPCaAqO46MgnOM80zW1RWuH61DGLwZJEdK2Kadq2F9CUG65" crossorigin="anonymous">

   <!-- <h1 class="col-3 col-md-3 col-lg-3 col-xl-2 text-center">Orders</h1>  -->
   <br>
   <div class="d-flex align-baseline justify-content-between align-items-center pl-5">
          <a href='/'><button type="submit" class="btn btn-success" mr-5>Go BACK</button></a>
          </div>
   

  <br><br>
  <table class="table" id="table">
    <thead>
      <tr>
        <th scope="col" class="col-3 col-md-3 col-lg-3 col-xl-2 text-center" >Order ID</th>
        <th scope="col"class="col-3 col-md-3 col-lg-3 col-xl-2 text-center">Amount</th>
        <th scope="col"class="col-3 col-md-3 col-lg-3 col-xl-2 text-center">Payment Status</th>
        <th scope="col"class="col-3 col-md-3 col-lg-3 col-xl-2 text-center">Payment Method</th>
        <th scope="col"class="col-3 col-md-3 col-lg-3 col-xl-2 text-center">Order Status</th>
        <th scope="col"class="col-3 col-md-3 col-lg-3 col-xl-2 text-center">Delivery Date</th>
        <th scope="col"class="col-3 col-md-3 col-lg-3 col-xl-2 text-center">Product Details</th>
        
      </tr>
    </thead>

    <tbody>
        <% if (allData.length === 0) { %>
            <div
              class="d-flex flex-column align-items-center justify-content-center"
            >
              <span class="material-symbols-outlined" style="font-size: 100px">
               
              </span>
              <h1>No Order History</h1>
              <a href="/shop" style="color: #003049; text-decoration: none"
                >Continue Shopping</a
              >
            </div>
            <% } else {%> <%allData.forEach(data => { %>
      <tr>
        <td class="col-3 col-md-3 col-lg-3 col-xl-2 text-center">
            #<%= data.order_id %>
        </td>
        
        <td class="col-3 col-md-3 col-lg-3 col-xl-2 text-center">
            Rs.<%= data.totalAmount %>
        </td>
        
        <td class="col-3 col-md-3 col-lg-3 col-xl-2 text-center">
            <%= data.paymentStatus%>
        </td>
        <td class="col-3 col-md-3 col-lg-3 col-xl-2 text-center">
            <%= data.paymentMethod %>
        </td>
        <td class="col-3 col-md-3 col-lg-3 col-xl-2 text-center">
          <%= data.orderStatus%>
        </td>
        <td class="col-3 col-md-3 col-lg-3 col-xl-2 text-center">
            <%= data.expectedDelivery %>
        </td>

        <td>

        <div>
          <button
            type="button"
            class="btn btn-primary btn-sm"
            data-bs-toggle="modal"
            data-bs-target="#model-<%= data.order_id %>"
          >
            Products
          </button>
        </div>
      </div>
      
      <div
        class="modal fade"
        id="model-<%= data.order_id %>"
        tabindex="-1"
        aria-labelledby="<%= data.order_id %>Label"
        aria-hidden="true"
      >
      <br><br><br><br><br><br><br>
        <div class="modal-dialog">
          <div class="modal-content">
            <div class="modal-header">
              <h1
                class="modal-title fs-5"
                id="<%= data.order_id %>Label"
              >
                Products
              </h1>
              <button
                type="button"
                class="btn-close"
                data-bs-dismiss="modal"
                aria-label="Close"
              ></button>
            </div>
            <div class="modal-body">
              <div class="p-3">
                <div class="d-flex flex-column justify-content-center">
                  <% productData.forEach(element => { %> <% if
                  (data.order_id == element.order_id+'') { %>
                  <div
                    class="d-flex justify-content-start"
                    style="border: 0.5px solid #d9d9d9"
                  >
                    <div>
                      <img
                        src="<%= element.productDetail.image[2].url %>"
                        alt=""
                        style="width: 100px; height: 100px"
                      />
                    </div>
                    <div>
                      <div>
                        <%= element.productDetail.name %>
                      </div>
                      <div>Qty: <%= element.productQuantity %></div>
                      <div>Total: <%= element.productPrice %></div>
                    </div>
                  </div>
                  <% } %> <% }) %>
                </div>
              </div>
            </div>
            <div class="modal-footer">
              <button
                type="button"
                class="btn btn-secondary"
                data-bs-dismiss="modal"
              >
                Close
              </button>
            </div>
          </td>


        <% }) %> <% } %>
</tbody>
</table>
</div>
</div>
</div>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/js/bootstrap.bundle.min.js"
integrity="sha384-kenU1KFdBIe4zVF0s0G1M5b4hcpxyD9F7jL+jjXkk+Q2h455rYXK/7HAuoJl+0I4"
crossorigin="anonymous"></script>
</body>
</html>